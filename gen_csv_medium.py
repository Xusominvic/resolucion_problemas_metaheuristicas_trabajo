
exact_data = """medium_15x2_1,FEASIBLE,812.0,3600.1,91.96
medium_15x2_2,FEASIBLE,765.0,3600.5,91.73
medium_15x2_3,FEASIBLE,877.0,3600.3,97.52
medium_15x2_4,FEASIBLE,784.0,3600.3,108.51
medium_15x2_5,FEASIBLE,674.0,3600.1,84.15
medium_15x3_1,FEASIBLE,506.0,3600.9,38.25
medium_15x3_2,FEASIBLE,554.0,3600.7,42.78
medium_15x3_3,FEASIBLE,628.0,3600.2,55.06
medium_15x3_4,FEASIBLE,572.0,3600.2,43.00
medium_15x3_5,FEASIBLE,599.0,3600.2,47.90
medium_15x4_1,FEASIBLE,436.0,3600.2,25.29
medium_15x4_2,FEASIBLE,447.0,3602.3,25.92
medium_15x4_3,FEASIBLE,356.0,3600.3,20.27
medium_15x4_4,FEASIBLE,374.0,3600.3,16.88
medium_15x4_5,FEASIBLE,387.0,3601.2,24.84
medium_16x2_1,FEASIBLE,891.0,3600.1,100.22
medium_16x2_2,FEASIBLE,801.0,3600.3,87.59
medium_16x2_3,FEASIBLE,860.0,3600.1,79.92
medium_16x2_4,FEASIBLE,890.0,3600.1,93.90
medium_16x2_5,FEASIBLE,835.0,3600.6,88.91
medium_16x3_1,FEASIBLE,565.0,3602.1,50.27
medium_16x3_2,FEASIBLE,567.0,3600.5,62.00
medium_16x3_3,FEASIBLE,602.0,3601.3,52.02
medium_16x3_4,FEASIBLE,654.0,3600.2,60.29
medium_16x3_5,FEASIBLE,617.0,3600.2,60.68
medium_16x4_1,FEASIBLE,430.0,3600.8,37.38
medium_16x4_2,FEASIBLE,402.0,3600.2,31.37
medium_16x4_3,FEASIBLE,446.0,3600.7,33.53
medium_16x4_4,FEASIBLE,452.0,3600.2,36.56
medium_16x4_5,FEASIBLE,408.0,3600.2,30.35
medium_17x2_1,FEASIBLE,825.0,3600.2,100.73
medium_17x2_2,FEASIBLE,912.0,3600.2,105.41
medium_17x2_3,FEASIBLE,934.0,3600.3,107.56
medium_17x2_4,FEASIBLE,960.0,3600.1,107.34
medium_17x2_5,FEASIBLE,1022.0,3600.1,116.53
medium_17x3_1,FEASIBLE,649.0,3600.2,74.46
medium_17x3_2,FEASIBLE,778.0,3600.2,68.76
medium_17x3_3,FEASIBLE,664.0,3600.2,71.13
medium_17x3_4,FEASIBLE,580.0,3601.3,65.71
medium_17x3_5,FEASIBLE,566.0,3600.2,60.34
medium_17x4_1,FEASIBLE,509.0,3600.8,42.98
medium_17x4_2,FEASIBLE,452.0,3601.9,46.28
medium_17x4_3,FEASIBLE,399.0,3600.3,44.04
medium_17x4_4,FEASIBLE,496.0,3600.8,52.15
medium_17x4_5,FEASIBLE,405.0,3600.5,32.79
medium_18x2_1,FEASIBLE,989.0,3600.2,117.36
medium_18x2_2,FEASIBLE,771.0,3600.2,106.15
medium_18x2_3,FEASIBLE,920.0,3600.2,109.57
medium_18x2_4,FEASIBLE,941.0,3600.3,113.86
medium_18x2_5,FEASIBLE,1052.0,3600.2,118.71
medium_18x3_1,FEASIBLE,652.0,3600.2,79.61
medium_18x3_2,FEASIBLE,753.0,3600.5,85.01
medium_18x3_3,FEASIBLE,688.0,3600.2,82.01
medium_18x3_4,FEASIBLE,629.0,3600.2,71.86
medium_18x3_5,FEASIBLE,633.0,3600.5,74.38
medium_18x4_1,FEASIBLE,499.0,3600.3,60.45
medium_18x4_2,FEASIBLE,503.0,3601.0,91.25
medium_18x4_3,FEASIBLE,462.0,3600.2,45.28
medium_18x4_4,FEASIBLE,484.0,3600.2,56.63
medium_18x4_5,FEASIBLE,510.0,3602.2,71.14
medium_19x2_1,FEASIBLE,1029.0,3600.3,129.18
medium_19x2_2,FEASIBLE,992.0,3600.2,119.47
medium_19x2_3,FEASIBLE,993.0,3600.2,131.47
medium_19x2_4,FEASIBLE,1032.0,3600.2,131.39
medium_19x2_5,FEASIBLE,850.0,3600.2,126.06
medium_19x3_1,FEASIBLE,707.0,3600.3,80.82
medium_19x3_2,FEASIBLE,652.0,3600.2,84.18
medium_19x3_3,FEASIBLE,640.0,3600.2,77.29
medium_19x3_4,FEASIBLE,686.0,3601.2,94.33
medium_19x3_5,FEASIBLE,736.0,3600.2,98.92
medium_19x4_1,FEASIBLE,547.0,3600.3,54.08
medium_19x4_2,FEASIBLE,499.0,3600.3,58.41
medium_19x4_3,FEASIBLE,468.0,3601.0,56.52
medium_19x4_4,FEASIBLE,555.0,3600.8,68.18
medium_19x4_5,FEASIBLE,506.0,3600.5,60.63
medium_20x2_1,FEASIBLE,1041.0,3600.2,146.10
medium_20x2_2,FEASIBLE,1159.0,3600.1,140.96
medium_20x2_3,FEASIBLE,963.0,3600.2,141.35
medium_20x2_4,FEASIBLE,1080.0,3600.2,142.15
medium_20x2_5,FEASIBLE,1122.0,3600.1,136.21
medium_20x3_1,FEASIBLE,734.0,3600.3,96.26
medium_20x3_2,FEASIBLE,720.0,3600.3,100.56
medium_20x3_3,FEASIBLE,585.0,3601.0,88.10
medium_20x3_4,FEASIBLE,694.0,3600.2,98.85
medium_20x3_5,FEASIBLE,821.0,3600.3,98.31
medium_20x4_1,FEASIBLE,546.0,3601.8,73.89
medium_20x4_2,FEASIBLE,516.0,3600.2,84.95
medium_20x4_3,FEASIBLE,425.0,3600.3,62.21
medium_20x4_4,FEASIBLE,480.0,3600.2,64.95
medium_20x4_5,FEASIBLE,561.0,3600.3,74.77"""

random_data = """medium_15x2_1          | 811.2      | 5.64       | 799.0    | 1.53    
medium_15x2_2          | 766.2      | 7.24       | 754.0    | 1.62    
medium_15x2_3          | 877.4      | 6.49       | 863.0    | 1.67    
medium_15x2_4          | 785.6      | 5.96       | 772.0    | 1.76    
medium_15x2_5          | 674.0      | 5.37       | 662.0    | 1.81    
medium_15x3_1          | 506.6      | 8.90       | 495.0    | 2.34    
medium_15x3_2          | 558.2      | 9.37       | 545.0    | 2.42    
medium_15x3_3          | 633.0      | 11.93      | 612.0    | 3.43    
medium_15x3_4          | 572.6      | 8.48       | 563.0    | 1.71    
medium_15x3_5          | 601.4      | 10.06      | 590.0    | 1.93    
medium_15x4_1          | 447.2      | 13.49      | 423.0    | 5.72    
medium_15x4_2          | 451.0      | 11.57      | 435.0    | 3.68    
medium_15x4_3          | 360.0      | 13.98      | 339.0    | 6.19    
medium_15x4_4          | 374.0      | 11.64      | 365.0    | 2.47    
medium_15x4_5          | 390.0      | 11.67      | 369.0    | 5.69    
medium_16x2_1          | 892.2      | 8.69       | 877.0    | 1.73    
medium_16x2_2          | 800.6      | 7.15       | 786.0    | 1.86    
medium_16x2_3          | 860.0      | 6.19       | 845.0    | 1.78    
medium_16x2_4          | 890.0      | 7.51       | 876.0    | 1.60    
medium_16x2_5          | 837.0      | 7.44       | 823.0    | 1.70    
medium_16x3_1          | 566.8      | 13.36      | 553.0    | 2.50    
medium_16x3_2          | 567.6      | 10.03      | 555.0    | 2.27    
medium_16x3_3          | 602.4      | 9.95       | 593.0    | 1.59    
medium_16x3_4          | 654.0      | 10.93      | 640.0    | 2.19    
medium_16x3_5          | 622.0      | 9.35       | 604.0    | 2.98    
medium_16x4_1          | 432.4      | 14.51      | 417.0    | 3.69    
medium_16x4_2          | 403.6      | 13.81      | 383.0    | 5.38    
medium_16x4_3          | 450.8      | 12.76      | 430.0    | 4.84    
medium_16x4_4          | 452.0      | 12.68      | 432.0    | 4.63    
medium_16x4_5          | 410.8      | 12.64      | 398.0    | 3.22    
medium_17x2_1          | 825.0      | 7.02       | 812.0    | 1.60    
medium_17x2_2          | 914.4      | 8.11       | 898.0    | 1.83    
medium_17x2_3          | 935.0      | 9.65       | 922.0    | 1.41    
medium_17x2_4          | 961.6      | 7.18       | 948.0    | 1.43    
medium_17x2_5          | 1023.4     | 7.75       | 1009.0   | 1.43    
medium_17x3_1          | 649.8      | 11.97      | 634.0    | 2.49    
medium_17x3_2          | 778.2      | 11.03      | 763.0    | 1.99    
medium_17x3_3          | 669.8      | 10.33      | 651.0    | 2.89    
medium_17x3_4          | 580.0      | 11.89      | 565.0    | 2.65    
medium_17x3_5          | 566.0      | 12.42      | 555.0    | 1.98    
medium_17x4_1          | 509.8      | 23.13      | 491.0    | 3.83    
medium_17x4_2          | 456.0      | 19.45      | 441.0    | 3.40    
medium_17x4_3          | 401.4      | 19.55      | 386.0    | 3.99    
medium_17x4_4          | 498.0      | 17.28      | 474.0    | 5.06    
medium_17x4_5          | 408.8      | 16.81      | 394.0    | 3.76    
medium_18x2_1          | 988.8      | 9.85       | 971.0    | 1.83    
medium_18x2_2          | 772.2      | 8.55       | 756.0    | 2.14    
medium_18x2_3          | 922.4      | 8.99       | 908.0    | 1.59    
medium_18x2_4          | 942.0      | 7.53       | 923.0    | 2.06    
medium_18x2_5          | 1051.0     | 10.50      | 1035.0   | 1.55    
medium_18x3_1          | 652.6      | 15.08      | 638.0    | 2.29    
medium_18x3_2          | 753.4      | 14.57      | 736.0    | 2.36    
medium_18x3_3          | 689.0      | 17.92      | 676.0    | 1.92    
medium_18x3_4          | 631.4      | 12.48      | 615.0    | 2.67    
medium_18x3_5          | 633.2      | 14.83      | 620.0    | 2.13    
medium_18x4_1          | 501.2      | 16.30      | 485.0    | 3.34    
medium_18x4_2          | 504.4      | 16.86      | 490.0    | 2.94    
medium_18x4_3          | 460.4      | 17.63      | 445.0    | 3.46    
medium_18x4_4          | 488.8      | 23.29      | 472.0    | 3.56    
medium_18x4_5          | 511.0      | 21.62      | 492.0    | 3.86    
medium_19x2_1          | 1029.4     | 9.82       | 1016.0   | 1.32    
medium_19x2_2          | 993.6      | 6120.9       | 979.0    | 1.49    
medium_19x2_3          | 994.2      | 9.72       | 982.0    | 1.24    
medium_19x2_4          | 1035.4     | 9.56       | 1018.0   | 1.71    
medium_19x2_5          | 852.4      | 9.34       | 836.0    | 1.96    
medium_19x3_1          | 706.0      | 15.36      | 691.0    | 2.17    
medium_19x3_2          | 653.4      | 18.40      | 638.0    | 2.41    
medium_19x3_3          | 636.8      | 17.14      | 625.0    | 1.89    
medium_19x3_4          | 687.0      | 16.07      | 670.0    | 2.54    
medium_19x3_5          | 732.8      | 13.26      | 719.0    | 1.92    
medium_19x4_1          | 553.4      | 19.79      | 532.0    | 4.02    
medium_19x4_2          | 502.4      | 21.47      | 486.0    | 3.37    
medium_19x4_3          | 469.4      | 24.35      | 455.0    | 3.16    
medium_19x4_4          | 557.8      | 19.10      | 533.0    | 4.65    
medium_19x4_5          | 508.8      | 19.08      | 489.0    | 4.05    
medium_20x2_1          | 1040.2     | 10.41      | 1021.0   | 1.88    
medium_20x2_2          | 1162.4     | 10.06      | 1142.0   | 1.79    
medium_20x2_3          | 959.8      | 10.40      | 942.0    | 1.89    
medium_20x2_4          | 1074.6     | 10.32      | 1059.0   | 1.47    
medium_20x2_5          | 1122.0     | 12.28      | 1103.0   | 1.72    
medium_20x3_1          | 734.6      | 16.42      | 721.0    | 1.89    
medium_20x3_2          | 719.0      | 13.99      | 700.0    | 2.71    
medium_20x3_3          | 587.6      | 14.33      | 576.0    | 2.01    
medium_20x3_4          | 695.6      | 14.72      | 680.0    | 2.29    
medium_20x3_5          | 821.6      | 15.44      | 804.0    | 2.19    
medium_20x4_1          | 550.0      | 29.13      | 533.0    | 3.19    
medium_20x4_2          | 514.6      | 28.62      | 503.0    | 2.31    
medium_20x4_3          | 422.2      | 25.27      | 408.0    | 3.48    
medium_20x4_4          | 474.0      | 19.80      | 462.0    | 2.60    
medium_20x4_5          | 561.4      | 19.85      | 545.0    | 3.01    """

grasp_data = """medium_15x2_1          | 811.2      | 7.39       | 799.0    | 1.53    
medium_15x2_2          | 766.2      | 6.98       | 754.0    | 1.62    
medium_15x2_3          | 878.0      | 7.27       | 863.0    | 1.74    
medium_15x2_4          | 785.8      | 6.53       | 772.0    | 1.79    
medium_15x2_5          | 674.2      | 6.27       | 662.0    | 1.84    
medium_15x3_1          | 507.4      | 11.06      | 495.0    | 2.51    
medium_15x3_2          | 556.6      | 9.96       | 545.0    | 2.13    
medium_15x3_3          | 633.8      | 12.15      | 612.0    | 3.56    
medium_15x3_4          | 572.6      | 9.58       | 563.0    | 1.71    
medium_15x3_5          | 602.6      | 13.34      | 590.0    | 2.14    
medium_15x4_1          | 453.8      | 18.92      | 423.0    | 7.28    
medium_15x4_2          | 451.0      | 43.85      | 435.0    | 3.68    
medium_15x4_3          | 359.4      | 34.77      | 339.0    | 6.02    
medium_15x4_4          | 374.4      | 32.84      | 365.0    | 2.58    
medium_15x4_5          | 390.4      | 33.69      | 369.0    | 5.80    
medium_16x2_1          | 893.8      | 19.52      | 877.0    | 1.92    
medium_16x2_2          | 800.8      | 24.53      | 786.0    | 1.88    
medium_16x2_3          | 861.0      | 18.03      | 845.0    | 1.89    
medium_16x2_4          | 891.2      | 19.15      | 876.0    | 1.74    
medium_16x2_5          | 837.0      | 19.32      | 823.0    | 1.70    
medium_16x3_1          | 566.8      | 37.81      | 553.0    | 2.50    
medium_16x3_2          | 567.8      | 33.76      | 555.0    | 2.31    
medium_16x3_3          | 603.0      | 29.06      | 593.0    | 1.69    
medium_16x3_4          | 654.6      | 30.75      | 640.0    | 2.28    
medium_16x3_5          | 620.2      | 40.11      | 604.0    | 2.68    
medium_16x4_1          | 431.6      | 59.05      | 417.0    | 3.50    
medium_16x4_2          | 402.6      | 38.30      | 383.0    | 5.12    
medium_16x4_3          | 451.4      | 45.90      | 430.0    | 4.98    
medium_16x4_4          | 452.0      | 32.57      | 432.0    | 4.63    
medium_16x4_5          | 409.8      | 33.08      | 398.0    | 2.96    
medium_17x2_1          | 825.0      | 20.95      | 812.0    | 1.60    
medium_17x2_2          | 914.2      | 21.27      | 898.0    | 1.80    
medium_17x2_3          | 933.4      | 27.61      | 922.0    | 1.24    
medium_17x2_4          | 960.0      | 24.98      | 948.0    | 1.27    
medium_17x2_5          | 1025.8     | 20.23      | 1009.0   | 1.67    
medium_17x3_1          | 649.6      | 28.43      | 634.0    | 2.46    
medium_17x3_2          | 778.8      | 14.73      | 763.0    | 2.07    
medium_17x3_3          | 670.8      | 12.51      | 651.0    | 3.04    
medium_17x3_4          | 578.8      | 12.90      | 565.0    | 2.44    
medium_17x3_5          | 566.0      | 11.36      | 555.0    | 1.98    
medium_17x4_1          | 511.0      | 21.15      | 491.0    | 4.07    
medium_17x4_2          | 457.2      | 18.47      | 441.0    | 3.67    
medium_17x4_3          | 401.6      | 21.12      | 386.0    | 4.04    
medium_17x4_4          | 498.8      | 16.42      | 474.0    | 5.23    
medium_17x4_5          | 410.4      | 15.50      | 394.0    | 4.16    
medium_18x2_1          | 988.2      | 10.66      | 971.0    | 1.77    
medium_18x2_2          | 771.8      | 10.91      | 756.0    | 2.09    
medium_18x2_3          | 923.4      | 10.48      | 908.0    | 1.70    
medium_18x2_4          | 943.6      | 10.19      | 923.0    | 2.23    
medium_18x2_5          | 1052.4     | 10.31      | 1035.0   | 1.68    
medium_18x3_1          | 652.2      | 14.97      | 638.0    | 2.23    
medium_18x3_2          | 753.4      | 13.85      | 736.0    | 2.36    
medium_18x3_3          | 688.6      | 15.62      | 676.0    | 1.86    
medium_18x3_4          | 630.8      | 13.33      | 615.0    | 2.57    
medium_18x3_5          | 633.6      | 14.19      | 620.0    | 2.19    
medium_18x4_1          | 499.8      | 18.03      | 485.0    | 3.05    
medium_18x4_2          | 504.4      | 17.20      | 490.0    | 2.94    
medium_18x4_3          | 461.6      | 21.68      | 445.0    | 3.73    
medium_18x4_4          | 488.6      | 17.64      | 472.0    | 3.52    
medium_18x4_5          | 514.6      | 16.74      | 492.0    | 4.59    
medium_19x2_1          | 1029.0     | 9.40       | 1016.0   | 1.28    
medium_19x2_2          | 992.6      | 10.69      | 979.0    | 1.39    
medium_19x2_3          | 993.0      | 10.79      | 982.0    | 1.12    
medium_19x2_4          | 1035.8     | 10.78      | 1018.0   | 1.75    
medium_19x2_5          | 853.2      | 9.17       | 836.0    | 2.06    
medium_19x3_1          | 706.0      | 18.66      | 691.0    | 2.17    
medium_19x3_2          | 654.0      | 14.18      | 638.0    | 2.51    
medium_19x3_3          | 637.4      | 16.19      | 625.0    | 1.98    
medium_19x3_4          | 687.2      | 15.80      | 670.0    | 2.54    
medium_19x3_5          | 732.6      | 15.03      | 719.0    | 1.89    
medium_19x4_1          | 551.8      | 19.52      | 532.0    | 3.72    
medium_19x4_2          | 501.0      | 21.88      | 486.0    | 3.09    
medium_19x4_3          | 469.2      | 21.78      | 455.0    | 3.12    
medium_19x4_4          | 555.2      | 20.07      | 533.0    | 4.17    
medium_19x4_5          | 506.4      | 24.93      | 489.0    | 3.56    
medium_20x2_1          | 1040.6     | 11.78      | 1021.0   | 1.92    
medium_20x2_2          | 1163.2     | 10.34      | 1142.0   | 1.86    
medium_20x2_3          | 959.8      | 12.38      | 942.0    | 1.89    
medium_20x2_4          | 1077.0     | 11.10      | 1059.0   | 1.70    
medium_20x2_5          | 1123.0     | 10.13      | 1103.0   | 1.81    
medium_20x3_1          | 736.2      | 16.83      | 721.0    | 2.11    
medium_20x3_2          | 718.6      | 17.01      | 700.0    | 2.66    
medium_20x3_3          | 585.0      | 16.08      | 576.0    | 1.56    
medium_20x3_4          | 694.0      | 14.73      | 680.0    | 2.06    
medium_20x3_5          | 821.0      | 20.79      | 804.0    | 2.11    
medium_20x4_1          | 555.4      | 25.53      | 533.0    | 4.20    
medium_20x4_2          | 514.6      | 23.21      | 503.0    | 2.31    
medium_20x4_3          | 423.4      | 785.57     | 408.0    | 3.77    
medium_20x4_4          | 477.0      | 27.55      | 462.0    | 3.25    
medium_20x4_5          | 561.4      | 19.76      | 545.0    | 3.01    """

def process_data(data, csv_format=False):
    lines = data.strip().split("\n")
    results = {}
    for line in lines:
        if csv_format:
            parts = line.split(",")
            instancia = parts[0]
            mk = float(parts[2])
            time = float(parts[3])
        else:
            parts = [p.strip() for p in line.split("|")]
            instancia = parts[0]
            mk = float(parts[1])
            time = float(parts[2])
            gap = float(parts[4])
        
        comb = instancia.split("_")[1]
        if comb not in results:
            results[comb] = []
        if csv_format:
            results[comb].append((mk, time))
        else:
            results[comb].append((mk, time, gap))
    
    summary = {}
    for comb, vals in results.items():
        if csv_format:
            avg_mk = sum(v[0] for v in vals) / len(vals)
            avg_time = sum(v[1] for v in vals) / len(vals)
            summary[comb] = (avg_mk, avg_time)
        else:
            avg_mk = sum(v[0] for v in vals) / len(vals)
            avg_time = sum(v[1] for v in vals) / len(vals)
            avg_gap = sum(v[2] for v in vals) / len(vals)
            summary[comb] = (avg_mk, avg_time, avg_gap)
    return summary

exact_sum = process_data(exact_data, True)
random_sum = process_data(random_data)
grasp_sum = process_data(grasp_data)

combs = sorted(list(exact_sum.keys()), key=lambda x: [int(c) for c in x.split("x")])

output = "Combination,MK exacto,Time Exacto,MK random,Time Random,GAP RAndom,MK Grasp,Time GRASP,GAP GRASP\n"
for c in combs:
    e = exact_sum[c]
    r = random_sum[c]
    g = grasp_sum[c]
    output += f"{c},{round(e[0],4)},{round(e[1],4)},{round(r[0],4)},{round(r[1],4)},{round(r[2],4)},{round(g[0],4)},{round(g[1],4)},{round(g[2],4)}\n"

with open(r"c:\Users\jocarles\Documents\resolucion_problemas_metaheuristicas_trabajo\results_v2\resumen_resultados_medium.csv", "w") as f:
    f.write(output)

print("CSV created successfully")
